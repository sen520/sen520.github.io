---
title: R-数据结构
date: 2019-10-20
updated: 2019-10-20
categories:
- R
---

##### 1. vector向量

向量是用于存储数值型、字符型或逻辑性数据的一维数组。执行组合功能函数`c()`可用来创建向量。

```R
> a <- c(1,2,5,3,6,-2, 4)
> b <- c("apple", "pear", "orange")
> c <- c(TRUE, FALSE, TRUE, FALSE, TRUE)
```

这里，a是数值型向量，b是字符型向量，c是逻辑型向量

**注意：**单个向量中的数据必须拥有相同的类型或模式（数值型，字符型，逻辑型）。同一向量中无法混杂不同模式的数据。

```R
> b[1]
[1] "apple"
> b[c(1,3)]
[1] "apple"  "orange"
> c[c(2:4)]
[1] FALSE  TRUE FALSE
```

##### 2. matrix 矩阵

矩阵是一个二维数组，只是每个元素都拥有相同的模式（数值型，字符型或逻辑型）。可以通过函数`matrix()`创建矩阵。

一般格式为`mymatrix <- matrix(vector, nrow=number_of_rows, ncol=number_of_columns, byrow=logical_value)`

其中vector包含了矩阵的元素，nrow和ncol用以指定行和列的维数，dimnames包含了可选的、以字符型向量表示的行名和列名。选项byrow则表明矩阵应当按行填充（byrow=TRUE）还是按列填充（byrow=FALSE）,默认情况下按列填充。

```R
> myMatrix <- matrix(1:15, nrow=3, ncol=5)
> myMatrix
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    4    7   10   13
[2,]    2    5    8   11   14
[3,]    3    6    9   12   15
> y <- matrix(1:20, nrow = 5, ncol=4)
> y
     [,1] [,2] [,3] [,4]
[1,]    1    6   11   16
[2,]    2    7   12   17
[3,]    3    8   13   18
[4,]    4    9   14   19
[5,]    5   10   15   20
> cells <- c(1, 26, 24, 68)
> rnames <- c("R1", "R2")
> cnames <- c("C1", "C2")
> mymatrix <- matrix(cells, nrow = 2, ncol = 2, byrow=TRUE, dimnames=list(rnames, cnames)) # 按行填充
> mymatrix
   C1 C2
R1  1 26
R2 24 68
> mymatrix <- matrix(cells, nrow=2, ncol=2, byrow=FALSE, dimnames = list(rnames, cnames))# 按列填充
> mymatrix
   C1 C2
R1  1 24
R2 26 68
```

我们可以使用下标和方括号来选择矩阵中的行、列或元素。`r X[i,]`指矩阵X中的第i行，`r X[,j]`指第j列，`r X[i, j]`指第i行第j个元素。选择多行或多列时，下标i或j可为数值型向量

```R
> myMatrix[2,]
[1]  2  5  8 11 14
> myMatrix[,3]
[1] 7 8 9
> myMatrix[2,3]
[1] 8
```

**矩阵都是二维的，和向量类似，矩阵中也仅能包含一种数据类型。**

##### 3. dataframe数据框

不同的列可以包含不同模式的数据。

`mydata <- data.frame(col1, col2, col3)`

**注意：**列与列之间数据类型可以不一样，但是每一列的数据类型必须一致。我们在讨论数据框时将交替使用数据列和变量。选取数据框中元素的方式：可以使用前术（如矩阵中的）下标记号，也可直接使用执行列名

```r
> students <- c("A", "B", "C", "D")
> math_score <- c(100, 80, 70, 95)
> english_score <- c(96, 86, 77, 99)
> students_scores <- data.frame(students, math_score, english_score)
> students_scores
  students math_score english_score
1        A        100            96
2        B         80            86
3        C         70            77
4        D         95            99

> students_scores[1,]
  students math_score english_score
1        A        100            96
> students_scores[,2]
[1] 100  80  70  95
> students_scores[,"math_score"]
[1] 100  80  70  95
> students_scores$math_score
[1] 100  80  70  95
```

`$`用来选取一个给定数据框中的某个特定的变量。

```r
> math <- data.frame(students_scores$students, students_scores$math_score)
> math
  students_scores.students students_scores.math_score
1                        A                        100
2                        B                         80
3                        C                         70
4                        D                         95
```

**attach(), detach(), with()**

函数`attch()`可以将数据框添加到R的搜索路径中，R在遇到一个变量名以后，将检查搜索路径中的数据框，以定位到这个变量。

```R
> attach(students_scores)
    summary(math_score)
    plot(math_score)
    plot(math_score)
  detach(students_scores)
```

`detach()`将数据框从搜索路径中移除。

```R
> with(students_scores, {
    summary(math_score, english_score)
    plot(students, math_score)
})
```

`with()`的局限性在于，赋值仅在此函数的括号内生效

如果需要创建在`with()`结构以外存在的对象，使用特殊赋值符`<<-`代替标准赋值符`<-`。

##### 4. 因子factor

因子factor又叫分类变量，有两种：名义型、有序型

- 名义型：没有顺序
- 有序型：有顺序关系但是没有数量关系，得不出来不同级别之间的差异具体是多少。 

```R
> excellence <- c("excellent", "bad", "good", "okay", "bad")
> excellence <- factor(excellence)
> excellence
[1] excellent bad       good      okay      bad      
Levels: bad excellent good okay
> excellence <- factor(excellence, order=TRUE, levels=c("bad", "okay", "good", "excellent"))
> excellence
[1] excellent bad       good      okay      bad      
Levels: bad < okay < good < excellent
> str(excellence) # 显示对象结构
 Factor w/ 4 levels "bad","excellent",..: 2 1 3 4 1
```

这里我们成功的把字符型变量excellence，先转换成了无序因子变量，再转换成了有顺序的因子变量。

数值型变量可以用levels和labels参数来编码成因子。如果男性被编码成1，女性被编码成2

```R
> sex <- c(1, 2, 2, 1, 2, 1, 1, 3)
> sex
[1] 1 2 2 1 2 1 1 3
> sex <- factor(sex, levels=c(1, 2), labels=c("Male", "Female"))
> sex
[1] Male   Female Female Male   Female Male   Male   <NA>  
Levels: Male Female
```

##### 5. list列表

列表是R数据类型中最为复杂的一种。

一般来说，列表就是一些对象（或成分，component）的有序集合。列表允许你整合若干（可能无关的）对象到单个对象名下。例如：某个列表中可能是若干向量、矩阵、数据框，甚至其他列表的组合。可以使用`list()`创建列表

```R
> a <- "My First List"
> b <- c(25, 26, 18, 39)
> c <- matrix(1:10, nrow=5)
> d <- c("one", "two", "three")
> mylist <- list(title=a, b, c, d)
> mylist
$title
[1] "My First List"

[[2]]
[1] 25 26 18 39

[[3]]
     [,1] [,2]
[1,]    1    6
[2,]    2    7
[3,]    3    8
[4,]    4    9
[5,]    5   10

[[4]]
[1] "one"   "two"   "three"
> mylist[[2]]
[1] 25 26 18 39
> mylist[["title"]]
[1] "My First List"
```

上述创建了一个列表，其中有四个成：一个字符串，一个数据型向量，一个矩阵以及一个字符串向量。可以组合任意多的对象，并将它们保存为一个列表。

可以通过在双重方括号中指明代表某个成分的数字或名称来访问列表中的元素。

##### 6. 数组

数组与矩阵类似，但是维度可以大于2。

`myarray <- array(vector, dimensions, dimnames)`

- `vector`：数据
- `dimensions`：数值型向量，给出了各个维度下标的最大值
- `dimnames`：可选，各维度名称标签的列表

```R
> dim1 <- c("A1", "A2")
> dim2 <- c("B1", "B2", "B3")
> dim3 <- c("C1", "C2", "C3", "C4")
> z <- array(1:24, c(2,3,4), dimnames = list(dim1, dim2, dim3))
> a
[1]  1  2  5  3  6 -2  4
> z
, , C1

   B1 B2 B3
A1  1  3  5
A2  2  4  6

, , C2

   B1 B2 B3
A1  7  9 11
A2  8 10 12

, , C3

   B1 B2 B3
A1 13 15 17
A2 14 16 18

, , C4

   B1 B2 B3
A1 19 21 23
A2 20 22 24
> z[1,2,3]
[1] 15
```



##### 注意

- 将一个值赋给某个变量、矩阵、数组或列表中一个不存在的元素时，R将自动扩展这个数据结构以容纳新值

```R
> x <- c(8, 6, 4)
> x[7] <- 10
> x
[1]  8  6  4 NA NA NA 10
```

- R中没有标量。标量以单元素向量的形式出现
- R中的下标不从0开始，从1开始
- 变量无法被声明，他们在首次被赋值时生成

